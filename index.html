<html>
<script src='https://d3js.org/d3.v5.min.js'></script>
<style> circle {fill: lightblue; stroke: black;} </style>
<body onload='init()'>
<svg width=600 height=600>
</svg>
<script>
async function init() {
////////////////////////////////////////////////////////////////////////////////////

// FINAL VERSION

const data = await d3.csv('https://hromadka.github.io/data/cars2017.csv');


// set the dimensions and margins of the graph
var margin = 50,
    width = 500,
    height = 500;

  var xScale = d3.scaleLog().base(10)
    .domain([10,150])
    .range([ 0, (width-(2*margin)) ]);

  var yScale = d3.scaleLog().base(10)
    .domain([10,150])
    .range([height - margin, 0]);

//  var rScale = d3.sum([d.EngineCylinders,2]);
console.log("rscale!");


//var xData = function (d) { return xScale(d.AverageCityMPG); };
//var yData = function (d) { return yScale(d.AverageHighwayMPG); };
//var rData = function (d) { return rScale(d.EngineCylinders); };


// append the svg object to the body of the page
var svg = d3.select('svg')
  .append("g")
    .attr("transform",
          "translate(" + margin + "," + 0 + ")");


  svg.selectAll("circle")
    .data(data)
    .enter().append("circle")
    .attr("cx", function (d) { return xScale(d.AverageCityMPG) } )
    .attr("cy", function (d) { return yScale(d.AverageHighwayMPG) } )
    .attr("r", function (d) { return parseInt(d.EngineCylinders)+2  } );


    // axes
    var xAxis = d3.axisBottom()
    	.scale(xScale)
        .tickValues([10,20,50,100])
    	.tickFormat(d3.format('~s'));

    var yAxis = d3.axisLeft()
    	.scale(yScale)
        .tickValues([10,20,50,100])
    	.tickFormat(d3.format('~s'));

    svg.append('g')
      	.attr('transform', 'translate(' + [0, 0] + ')')
      	.call(yAxis);

    svg.append('g')
      	.attr('transform', 'translate(' + [0, height-margin] + ')')
      	.call(xAxis);

////////////////////////////////////////////////////////////////////
}
</script>
</body>
</html>
